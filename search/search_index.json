{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to the TreeHacks developer documentation. This site contains information about our infrastructure and instructions for setting up our code locally, as well as how deployment works and common troubleshooting issues. You can also use this documentation to learn how to use your tools -- how to start and customize your own version of root , for example. Running the docs locally \u00b6 git clone https://github.com/TreeHacks/docs.git cd docs pip install -r requirements-docs.txt mkdocs serve Open up http://localhost:8000 in your browser.","title":"Home"},{"location":"#running-the-docs-locally","text":"git clone https://github.com/TreeHacks/docs.git cd docs pip install -r requirements-docs.txt mkdocs serve Open up http://localhost:8000 in your browser.","title":"Running the docs locally"},{"location":"cog/","text":"","title":"Cog"},{"location":"gavel/","text":"","title":"Gavel"},{"location":"login/","text":"","title":"Login"},{"location":"meet/","text":"","title":"Meet"},{"location":"submit/","text":"","title":"Submit"},{"location":"devops/account-inventory/","text":"All tech-related accounts. Name Description G Suite (hello@treehacks.com) Admin email Cloudflare (admin@treehacks.com) DNS management AWS AWS cloud resources Heroku Heroku cloud resources GitHub Code","title":"Account Inventory"},{"location":"devops/aws-inventory/","text":"This is a list of all resources we have running on AWS. We should update this page as we add / remove sources. Lambda functions \u00b6 Name Description todo Cognito signup trigger (dev) todo Cognito signup trigger (prod) Cognito user pools \u00b6 Name Description treehacks-dev Dev user accounts treehacks-prod Prod user accounts S3 buckets \u00b6 Name Description treehacks-uploads-dev File uploads from root (dev) treehacks-uploads-prod File uploads from root (prod) EC2 instances \u00b6 Name Description An instance in us-west-1 TreeHacks wiki","title":"AWS Inventory"},{"location":"devops/aws-inventory/#lambda-functions","text":"Name Description todo Cognito signup trigger (dev) todo Cognito signup trigger (prod)","title":"Lambda functions"},{"location":"devops/aws-inventory/#cognito-user-pools","text":"Name Description treehacks-dev Dev user accounts treehacks-prod Prod user accounts","title":"Cognito user pools"},{"location":"devops/aws-inventory/#s3-buckets","text":"Name Description treehacks-uploads-dev File uploads from root (dev) treehacks-uploads-prod File uploads from root (prod)","title":"S3 buckets"},{"location":"devops/aws-inventory/#ec2-instances","text":"Name Description An instance in us-west-1 TreeHacks wiki","title":"EC2 instances"},{"location":"devops/dns/","text":"Our DNS records are handled by Cloudflare. Adding a new record \u00b6 To add a new record, go to Cloudflare and add a record. Page Rules \u00b6 We have some custom page rules set up on Cloudflare as well, which allow us to cache specific endpoints or create custom redirects. For example, we have a custom page rule used to cache the API endpoint to get the list of all hacks from Gavel, for performance reasons. Warning about root CNAME records \u00b6 In the summer of 2018, we wanted https://treehacks.com to work properly (http:// and https://www. would work, but only https:// would give an error). We couldn't use Namecheap's default redirection service, because it wouldn't redirect https:// URLs. So, we tried adding a CNAME record at the root domain. However, this is a bad idea and ended up breaking all email for most of the summer, until we noticed it and reverted the CNAME record change. We made a similar mistake in the summer of 2019. When switching from Namecheap to Cloudflare, we wanted to fix https://treehacks.com again, so we used Cloudflare's CNAME flattening feature to add a CNAME record at the root again. However, we forgot that Namecheap had provided us with email forwarding services, so all emails stopped working. Again, we only noticed this a while later. When we realized this, we switched our treehacks.com email handling to G Suite. The lessons of this story are: When you make a big change to DNS, make sure you test that emails work immediately instead of waiting several weeks until the damage is done. Cloudflare Page Rules are probably a safer / more reliable way of doing redirects than doing DNS record redirection (with Page Rules, you can redirect from an SSL path as well -- so we could have solved our problem of https://treehacks.com using them without touching DNS).","title":"DNS"},{"location":"devops/dns/#adding-a-new-record","text":"To add a new record, go to Cloudflare and add a record.","title":"Adding a new record"},{"location":"devops/dns/#page-rules","text":"We have some custom page rules set up on Cloudflare as well, which allow us to cache specific endpoints or create custom redirects. For example, we have a custom page rule used to cache the API endpoint to get the list of all hacks from Gavel, for performance reasons.","title":"Page Rules"},{"location":"devops/dns/#warning-about-root-cname-records","text":"In the summer of 2018, we wanted https://treehacks.com to work properly (http:// and https://www. would work, but only https:// would give an error). We couldn't use Namecheap's default redirection service, because it wouldn't redirect https:// URLs. So, we tried adding a CNAME record at the root domain. However, this is a bad idea and ended up breaking all email for most of the summer, until we noticed it and reverted the CNAME record change. We made a similar mistake in the summer of 2019. When switching from Namecheap to Cloudflare, we wanted to fix https://treehacks.com again, so we used Cloudflare's CNAME flattening feature to add a CNAME record at the root again. However, we forgot that Namecheap had provided us with email forwarding services, so all emails stopped working. Again, we only noticed this a while later. When we realized this, we switched our treehacks.com email handling to G Suite. The lessons of this story are: When you make a big change to DNS, make sure you test that emails work immediately instead of waiting several weeks until the damage is done. Cloudflare Page Rules are probably a safer / more reliable way of doing redirects than doing DNS record redirection (with Page Rules, you can redirect from an SSL path as well -- so we could have solved our problem of https://treehacks.com using them without touching DNS).","title":"Warning about root CNAME records"},{"location":"devops/domain-inventory/","text":"All domains and subdomains owned by / related to TreeHacks. Name Description Hosted on https://www.treehacks.com Main site Heroku https://blog.treehacks.com Not used ? https://wiki.treehacks.com Internal wiki for organizers AWS EC2 https://beta.treehacks.com Not used Heroku https://cc.treehacks.com Not used Heroku https://expo.treehacks.com Project expo GitHub Pages https://docs.treehacks.com Docs site GitHub Pages https://gavel.treehacks.com Judging site Heroku https://gavel.dev.treehacks.com Judging site (dev) Heroku https://help.treehacks.com Help site Heroku https://help.dev.treehacks.com Help site (dev) Heroku https://leaderboard.treehacks.com Leaderboard site Heroku https://live.treehacks.com Live site Heroku https://login.treehacks.com Login site Heroku https://login.dev.treehacks.com Login site Heroku https://meet.treehacks.com Meet site Heroku https://treehacks-meet-dev.herokuapp.com/ Meet site (dev) (no custom domain for this yet) Heroku https://picontrol.treehacks.com Pi Control site Heroku https://picontrol.dev.treehacks.com Pi Control dev site Heroku https://root.treehacks.com Root site Heroku https://root.dev.treehacks.com Root site (dev) Heroku https://slack.treehacks.com Slack invite site Heroku https://submit.treehacks.com Submit site Heroku https://submit.dev.treehacks.com Submit site (dev) Heroku","title":"Domain Inventory"},{"location":"devops/g-suite/","text":"We have a single G Suite account with a single user -- hello@treehacks.com. Email routing \u00b6 We handle all incoming email through Freshdesk . We can create multiple routing rules by going to the Gmail routing settings page ( https://admin.google.com/u/0/ac/apps/gmail/defaultrouting?hl=en&pli=1 ): We have the following routing rules set up: sponsor@treehacks.com -> treehackscomsponsor@treehacks.freshdesk.com support@treehacks.com -> treehackscomsupport@treehacks.freshdesk.com travel@treehacks.com -> treehackscomtravel@treehacks.freshdesk.com appedits@treehacks.com -> treehackscomappedits@treehacks.freshdesk.com [everything else]@treehacks.com -> hello@treehacks.com These routing rules allow us to forward email to where it needs to go, without having to create multiple G Suite accounts for each email. Forwarding of hello@treehacks.com \u00b6 We also forward email from hello@treehacks.com -> treehackscomhello@treehacks.freshdesk.com. However, this behavior is not configured through a routing rule as for the other emails above. Instead, it is just configured through Gmail's standard forwarding options:","title":"G Suite"},{"location":"devops/g-suite/#email-routing","text":"We handle all incoming email through Freshdesk . We can create multiple routing rules by going to the Gmail routing settings page ( https://admin.google.com/u/0/ac/apps/gmail/defaultrouting?hl=en&pli=1 ): We have the following routing rules set up: sponsor@treehacks.com -> treehackscomsponsor@treehacks.freshdesk.com support@treehacks.com -> treehackscomsupport@treehacks.freshdesk.com travel@treehacks.com -> treehackscomtravel@treehacks.freshdesk.com appedits@treehacks.com -> treehackscomappedits@treehacks.freshdesk.com [everything else]@treehacks.com -> hello@treehacks.com These routing rules allow us to forward email to where it needs to go, without having to create multiple G Suite accounts for each email.","title":"Email routing"},{"location":"devops/g-suite/#forwarding-of-hellotreehackscom","text":"We also forward email from hello@treehacks.com -> treehackscomhello@treehacks.freshdesk.com. However, this behavior is not configured through a routing rule as for the other emails above. Instead, it is just configured through Gmail's standard forwarding options:","title":"Forwarding of hello@treehacks.com"},{"location":"devops/next-year/","text":"The general steps required for a new TreeHacks year are: Change passwords Reset data Reconfigure root Theme other sites Renew Stanford SAML Change passwords \u00b6 Change all passwords for accounts. This way, people from previous years from TreeHacks will not have access to any TreeHacks infrastructure. This reduces risk as only the people who know the credentials will be able to use the credentials. This includes: All accounts in Account Inventory The mentor signup token in root The password in picontrol (dev and prod) Gavel admin passwords (dev and prod) Additionally, you should remove admin permissions from users who are no longer with TreeHacks and have: Ownership status in the GitHub organization any access among the IAM users in AWS Member of the \"admin\" group in the treehacks-prod Cognito user pool (for root / all TreeHacks sites) Reset data \u00b6 Only root.treehacks.com supports collecting data from multiple years. If the database is big enough, it might be good to eventually clear it out / archive the data, but you won't need to do anything for now. Make sure you clear the databases that exist in: Gavel Meet Pi Control Additionally, do the following operations on the treehacks-prod Cognito user pool: Delete all accounts with a \"sponsor\" role (this way, next year's sponsors can be provisioned new accounts) Remove the \"mentor\" role from all accounts with a \"mentor\" role Remove the \"admin\" role from all users who are no longer admins (as mentioned above) Grant the \"admin\" role to users who need to become admins for this year (access all applications, etc.) Reconfigure root \u00b6 Create a new theme for root. Copy the existing theme (in this case pink_palm_tree.ts and pink_palm_tree.scss ) to new files. In these files, you can change the theme colors as needed; however, make sure you update the hackathon_year variable and deadlines array: export default { \"hackathon_year\" : 2020 , \"hackathon_date_range\" : \"February 14-16\" , \"deadlines\" : [ { \"key\" : \"oos\" , \"label\" : \"out-of-state\" , \"date\" : \"2019-11-19T07:59:00.000Z\" , \"display_date\" : \"November 18, 2019\" }, { \"key\" : \"is\" , \"label\" : \"in-state\" , \"date\" : \"2019-11-26T07:59:00.000Z\" , \"display_date\" : \"November 25, 2019\" }, { \"key\" : \"stanford\" , \"label\" : \"Stanford student\" , \"date\" : \"2020-02-14T07:59:00.000Z\" , \"display_date\" : \"February 13, 2020\" } ], \"logo\" : require ( './assets/logo.svg' ), \"favicon\" : require ( \"./assets/favicon.ico\" ), \"dashboard_background\" : require ( \"./assets/combined_circuit.svg\" ) }; In themes/settings.ts , change the import statement to import the new theme. import customConfig from \"./pink_palm_tree\" ; import defaultConfig from \"./default\" ; import { set } from \"lodash\" ; for ( let key in customConfig ) { set ( defaultConfig , key , customConfig [ key ]); } export default defaultConfig ; You must also change backend constants at backend/constants.ts . Make sure you change the HACKATHON_YEAR variable here, as well as other variables involving bus transportation routes and verticals. Theme other sites \u00b6 Theme all of our other sites. This will involve copying and pasting some CSS, because we don't have a way to store multiple themes on our other sites other than root. Updating SAML config \u00b6 Every year, you will need to update TreeHacks' SPDB SAML configuration so that Stanford sign-in keeps working. This configuration expires on September 18 every year. See Login for more information on how to do this.","title":"Preparing for the next year"},{"location":"devops/next-year/#change-passwords","text":"Change all passwords for accounts. This way, people from previous years from TreeHacks will not have access to any TreeHacks infrastructure. This reduces risk as only the people who know the credentials will be able to use the credentials. This includes: All accounts in Account Inventory The mentor signup token in root The password in picontrol (dev and prod) Gavel admin passwords (dev and prod) Additionally, you should remove admin permissions from users who are no longer with TreeHacks and have: Ownership status in the GitHub organization any access among the IAM users in AWS Member of the \"admin\" group in the treehacks-prod Cognito user pool (for root / all TreeHacks sites)","title":"Change passwords"},{"location":"devops/next-year/#reset-data","text":"Only root.treehacks.com supports collecting data from multiple years. If the database is big enough, it might be good to eventually clear it out / archive the data, but you won't need to do anything for now. Make sure you clear the databases that exist in: Gavel Meet Pi Control Additionally, do the following operations on the treehacks-prod Cognito user pool: Delete all accounts with a \"sponsor\" role (this way, next year's sponsors can be provisioned new accounts) Remove the \"mentor\" role from all accounts with a \"mentor\" role Remove the \"admin\" role from all users who are no longer admins (as mentioned above) Grant the \"admin\" role to users who need to become admins for this year (access all applications, etc.)","title":"Reset data"},{"location":"devops/next-year/#reconfigure-root","text":"Create a new theme for root. Copy the existing theme (in this case pink_palm_tree.ts and pink_palm_tree.scss ) to new files. In these files, you can change the theme colors as needed; however, make sure you update the hackathon_year variable and deadlines array: export default { \"hackathon_year\" : 2020 , \"hackathon_date_range\" : \"February 14-16\" , \"deadlines\" : [ { \"key\" : \"oos\" , \"label\" : \"out-of-state\" , \"date\" : \"2019-11-19T07:59:00.000Z\" , \"display_date\" : \"November 18, 2019\" }, { \"key\" : \"is\" , \"label\" : \"in-state\" , \"date\" : \"2019-11-26T07:59:00.000Z\" , \"display_date\" : \"November 25, 2019\" }, { \"key\" : \"stanford\" , \"label\" : \"Stanford student\" , \"date\" : \"2020-02-14T07:59:00.000Z\" , \"display_date\" : \"February 13, 2020\" } ], \"logo\" : require ( './assets/logo.svg' ), \"favicon\" : require ( \"./assets/favicon.ico\" ), \"dashboard_background\" : require ( \"./assets/combined_circuit.svg\" ) }; In themes/settings.ts , change the import statement to import the new theme. import customConfig from \"./pink_palm_tree\" ; import defaultConfig from \"./default\" ; import { set } from \"lodash\" ; for ( let key in customConfig ) { set ( defaultConfig , key , customConfig [ key ]); } export default defaultConfig ; You must also change backend constants at backend/constants.ts . Make sure you change the HACKATHON_YEAR variable here, as well as other variables involving bus transportation routes and verticals.","title":"Reconfigure root"},{"location":"devops/next-year/#theme-other-sites","text":"Theme all of our other sites. This will involve copying and pasting some CSS, because we don't have a way to store multiple themes on our other sites other than root.","title":"Theme other sites"},{"location":"devops/next-year/#updating-saml-config","text":"Every year, you will need to update TreeHacks' SPDB SAML configuration so that Stanford sign-in keeps working. This configuration expires on September 18 every year. See Login for more information on how to do this.","title":"Updating SAML config"},{"location":"root/admin-portal/","text":"","title":"Admin Portal"},{"location":"root/application-portal/","text":"","title":"Application Portal"},{"location":"root/overview/","text":"Root is our hackathon application portal. It is used for handling applications, monitoring and managing status of applicants, and exporting applicant data to make decisions and to share data with sponsors. Deployed environments \u00b6 Frontend (prod): https://root.treehacks.com/ Backend (prod): https://root.treehacks.com/api/doc/ Frontend (dev): https://root.dev.treehacks.com/ Backend (dev): https://root.dev.treehacks.com/api/doc/ History of root \u00b6 Root was developed in the summer of 2019 for TreeHacks 2019-20, and it was the main part of the TreeHacks tech stack them. For TreeHacks 2020-21, we added theming to the site and SSO integration with other sites.","title":"Overview"},{"location":"root/overview/#deployed-environments","text":"Frontend (prod): https://root.treehacks.com/ Backend (prod): https://root.treehacks.com/api/doc/ Frontend (dev): https://root.dev.treehacks.com/ Backend (dev): https://root.dev.treehacks.com/api/doc/","title":"Deployed environments"},{"location":"root/overview/#history-of-root","text":"Root was developed in the summer of 2019 for TreeHacks 2019-20, and it was the main part of the TreeHacks tech stack them. For TreeHacks 2020-21, we added theming to the site and SSO integration with other sites.","title":"History of root"},{"location":"root/sponsor-portal/","text":"","title":"Sponsor Portal"},{"location":"root/theming/","text":"","title":"Theming"}]}